# 跨站脚本注入和跨站请求伪造，怎么预防 200字回答这个面试题


跨站脚本注入（XSS）是一种攻击方式，攻击者把恶意脚本注入到可信网站并在其他用户的浏览器上执行，从而窃取数据、劫持会话或篡改页面内容。

XSS（跨站脚本注入）：对所有不信任输入做严格输出编码/转义（HTML、属性、JS、URL、CSS上下文分别处理），在服务端做输入校验与过滤；优先使用框架的模板绑定避免直接拼接 HTML；启用 Content-Security-Policy 限制可执行脚本来源；设置 HttpOnly 和 SameSite 的 Cookie，降低脚本窃取凭证风险。

跨站请求伪造（CSRF）是一种攻击，利用用户在已登录网站的身份，诱使其浏览器发送未经授权的请求，从而在不知情的情况下执行操作。

假设用户已经登录了 bank.com，并且浏览器保存了登录 Cookie。攻击者在 evil.com 上放了一个表单：

<img src="https://bank.com/transfer?to=attacker&amount=1000" />

当用户访问 evil.com 时，浏览器会自动携带 bank.com 的 Cookie 发起请求，结果用户的钱就被转到了攻击者账户，而用户完全不知情，这就是典型的 CSRF 攻击。



CSRF（跨站请求伪造）：对有副作用的请求使用防 CSRF Token（同步/异步令牌或 double-submit cookie），服务端校验；

CSRF Token 是服务端生成的唯一、不可预测的随机值，附加在每个敏感请求中，用于验证请求来源合法，防止跨站请求伪造攻击。

CSRF Token 是由服务端生成并绑定到用户会话的随机值，只有当前网站的页面或脚本能拿到这个 Token。