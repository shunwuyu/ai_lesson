# diff 算法

- 同层比对
- 简单 diff
    多节点 diff 算法的目的是为了尽量复用节点，通过移动节点代替创建。

    diff 算法的目的是根据 key 复用 dom 节点，通过移动节点而不是创建新节点来减少 dom 操作。
对于每个新的 vnode，在旧的 vnode 中根据 key 查找一下，如果没查找到，那就新增 dom 节点，如果查找到了，那就可以复用。
复用的话要不要移动要判断下下标，如果下标在 lastIndex 之后，就不需要移动，因为本来就在后面，反之就需要移动。
最后，把旧的 vnode 中在新 vnode 中没有的节点从 dom 树中删除。

- 双端 diff
    简单 diff 算法能够实现 dom 节点的复用，但有的时候会做一些没必要的移动。双端 diff 算法解决了这个问题，它是从两端进行对比。

    双端 diff 是头尾指针向中间移动的同时，对比头头、尾尾、头尾、尾头是否可以复用，如果可以的话就移动对应的 dom 节点。
    如果头尾没找到可复用节点就遍历 vnode 数组来查找，然后移动对应下标的节点到头部。
    最后还剩下旧的 vnode 就批量删除，剩下新的 vnode 就批量新增。


    - vue3 Vue 3 会在渲染过程中识别静态节点，并将其提升到渲染函数外部。这样，静态节点在后续的更新中不会被重新渲染，从而提高性能。

    Static Node Hoisting

    
