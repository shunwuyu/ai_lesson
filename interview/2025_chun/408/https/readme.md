- https 故事
    从前有个王子（用户浏览器）要给公主（服务器）写一封情书。但问题是，信必须经过一个神秘邮差（网络），而这个邮差有可能是个间谍（中间人攻击者）。如果王子直接写信，信里的内容就会被邮差偷看甚至篡改。

    为了保证信的机密性和真实性，他们决定使用加密技术。

    - 非对称加密上场（公钥和私钥）

    公主非常聪明，她提前生成了一对钥匙：

一把🔓公钥：可以公开给所有人，谁都可以用它加密信。

一把🔐私钥：自己秘密保存，只能自己解密用。

她把公钥放进了一个带有皇家印章的保险箱（数字证书），并通过一位皇家信使（证书颁发机构 CA）分发到全国。

王子收到这个保险箱，他先检查有没有皇家印章（验证这个证书是否是合法的、可信的），确认无误后，拿出公钥。

    - 王子发送对称密钥（混合加密）

    王子并不会用公钥直接写整封情书，因为非对称加密效率太低。他做了这样一件事：

    他自己先随机生成一个对称加密的密钥（比如 AES 密钥）。

    用公主的公钥把这个对称密钥加密。

    把这个加密后的密钥寄给公主。

    因为只有公主才有对应的私钥，所以只有她能解密出这个对称密钥。

    - 对称加密登场（速度快）

    现在，王子和公主都知道了这个对称密钥（别人不知道），接下来的通信就用这个密钥加密啦，速度快而且安全。

    即使那个神秘邮差偷到信息，因为他没有密钥，也解不开。

- 证书颁发机构（CA）揭秘
    你可能会问：王子怎么知道保险箱上的皇家印章是真的？


    这就是**证书颁发机构（CA）**的作用：

公主在创建公私钥时，会向 CA 提交一个请求，请求包含她的公钥和身份信息。

CA 会验证身份，如果确认这个“公主”确实是皇室成员，就会给她发一个带签名的证书（即 SSL 证书），包含：

公钥

主体身份信息（如域名）

有效期

CA 的数字签名

王子的浏览器内置了多个“皇家信使”（根证书），他会验证收到的证书是否由这些可信机构签发。只有签发者可信，这个证书才可信。


HTTPS 如何防中间人攻击
中间人想伪造服务器：他无法伪造合法的证书，因为 CA 不会给他签发（浏览器验证不通过）。

中间人想读取通信内容：他拿不到对称密钥，因为它是用服务器公钥加密的，只有服务器能解开。

中间人想篡改内容：通信中每次交互都附带校验机制（如 MAC），一改就暴露。